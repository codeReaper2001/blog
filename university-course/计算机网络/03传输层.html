<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.37" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-v2-demo.mrhope.site/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html"><meta property="og:site_name" content="CodeReaper's Blog"><meta property="og:title" content="传输层"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><title>传输层 | CodeReaper's Blog</title><meta name="description" content="个人博客">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/blog/assets/style.0f45db89.css">
    <link rel="modulepreload" href="/blog/assets/app.9f3d4d71.js"><link rel="modulepreload" href="/blog/assets/03传输层.html.52bff1c6.js"><link rel="modulepreload" href="/blog/assets/03传输层.html.e229ddf2.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/blog/" class="home-link"><img class="logo" src="/blog/logo.svg" alt="CodeReaper&#39;s Blog"><!----><span class="site-name hide-in-pad">CodeReaper&#39;s Blog</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/blog/" class="nav-link" arialabel="博客主页"><i class="icon iconfont icon-home"></i>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="前端"><span class="title"><i class="icon iconfont icon-news"></i>前端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/frontend/css/%E6%B5%AE%E5%8A%A8%E5%B1%9E%E6%80%A7.html" class="nav-link" arialabel="CSS"><!---->CSS<!----></a></li><li class="dropdown-item"><a href="/blog/frontend/typescript/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%92%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" class="nav-link" arialabel="Typescript"><!---->Typescript<!----></a></li><li class="dropdown-item"><a href="/blog/frontend/vue/01%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E5%92%8C%E6%8F%92%E5%80%BC%E6%93%8D%E4%BD%9C.html" class="nav-link" arialabel="Vue"><!---->Vue<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="后端"><span class="title"><i class="icon iconfont icon-api"></i>后端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/backend/java%E5%9F%BA%E7%A1%80/%E6%B3%A8%E8%A7%A3%E5%92%8C%E5%8F%8D%E5%B0%84/%E6%B3%A8%E8%A7%A3.html" class="nav-link" arialabel="java基础"><!---->java基础<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="大学课程"><span class="title"><i class="icon iconfont icon-study"></i>大学课程</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/university-course/" class="nav-link active" arialabel="操作系统"><!---->操作系统<!----></a></li><li class="dropdown-item"><a href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01%E6%A6%82%E8%BF%B0.html" class="nav-link" arialabel="计算机网络"><!---->计算机网络<!----></a></li><li class="dropdown-item"><a href="/blog/university-course/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/01%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2%E4%B8%8E%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE.html" class="nav-link" arialabel="数据库系统"><!---->数据库系统<!----></a></li></ul></button></div></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" arialabelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" arialabelledby="outlook"><title id="outlook" lang="en">outlook icon</title><g fill="currentColor"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></g></svg><div class="outlook-dropdown"><!----></div></button></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/blog/" class="nav-link sidebar-link sidebar-page" arialabel="博客主页"><i class="icon iconfont icon-home"></i>博客主页<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-news"></i><span class="title">前端</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-api"></i><span class="title">后端</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><i class="icon iconfont icon-study"></i><span class="title">大学课程</span><span class="arrow down"></span></button><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><i class="icon iconfont icon-network"></i><span class="title">计算机网络</span><span class="arrow down"></span></button><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><a href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01%E6%A6%82%E8%BF%B0.html" class="nav-link sidebar-link sidebar-page" arialabel="概述"><!---->概述<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/02%E5%BA%94%E7%94%A8%E5%B1%82.html" class="nav-link sidebar-link sidebar-page" arialabel="应用层"><!---->应用层<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" arialabel="传输层"><!---->传输层<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#一、传输层基本介绍" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="一、传输层基本介绍"><!---->一、传输层基本介绍<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-基本职能" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 基本职能"><!---->1. 基本职能<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-运输层端口号、复用分用的概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 运输层端口号、复用分用的概念"><!---->2. 运输层端口号、复用分用的概念<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#二、udp与tcp对比" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="二、UDP与TCP对比"><!---->二、UDP与TCP对比<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-是否连接" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 是否连接"><!---->1. 是否连接<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-单播、多播和广播" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 单播、多播和广播"><!---->2. 单播、多播和广播<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-面向报文和面向字节流" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="3. 面向报文和面向字节流"><!---->3. 面向报文和面向字节流<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_4-可靠性" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4. 可靠性"><!---->4. 可靠性<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_5-两种协议的格式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5. 两种协议的格式"><!---->5. 两种协议的格式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_6-小结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6. 小结"><!---->6. 小结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#三、tcp的流量控制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="三、TCP的流量控制"><!---->三、TCP的流量控制<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-流量控制的相关术语" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 流量控制的相关术语"><!---->1. 流量控制的相关术语<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-流量控制的流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 流量控制的流程"><!---->2. 流量控制的流程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-小结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="3. 小结"><!---->3. 小结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#四、tcp的拥塞控制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="四、TCP的拥塞控制"><!---->四、TCP的拥塞控制<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-简单介绍" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 简单介绍"><!---->1. 简单介绍<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-拥塞控制算法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 拥塞控制算法"><!---->2. 拥塞控制算法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-相关概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="3. 相关概念"><!---->3. 相关概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_4-拥塞控制的流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4. 拥塞控制的流程"><!---->4. 拥塞控制的流程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_5-例题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5. 例题"><!---->5. 例题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#五、tcp超时重传时间rto的计算" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="五、TCP超时重传时间RTO的计算"><!---->五、TCP超时重传时间RTO的计算<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-问题引入" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 问题引入"><!---->1. 问题引入<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-rto计算公式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. RTO计算公式"><!---->2. RTO计算公式<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#六、tcp滑动窗口和可靠传输" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="六、TCP滑动窗口和可靠传输"><!---->六、TCP滑动窗口和可靠传输<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-基于滑动窗口的发送过程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 基于滑动窗口的发送过程"><!---->1. 基于滑动窗口的发送过程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-注意点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 注意点"><!---->2. 注意点<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-例题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="3. 例题"><!---->3. 例题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#七、tcp连接的建立" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="七、TCP连接的建立"><!---->七、TCP连接的建立<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-连接建立需要解决的问题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 连接建立需要解决的问题"><!---->1. 连接建立需要解决的问题<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-连接的建立过程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 连接的建立过程"><!---->2. 连接的建立过程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-例题-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="3. 例题"><!---->3. 例题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#八、tcp连接的释放" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="八、TCP连接的释放"><!---->八、TCP连接的释放<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#九、tcp报文的首部格式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="九、TCP报文的首部格式"><!---->九、TCP报文的首部格式<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-字节流和tcp报文段的关系" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. 字节流和TCP报文段的关系"><!---->1. 字节流和TCP报文段的关系<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-格式与各部分的功能" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. 格式与各部分的功能"><!---->2. 格式与各部分的功能<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/04%E7%89%A9%E7%90%86%E5%B1%82.html" class="nav-link sidebar-link sidebar-page" arialabel="物理层"><!---->物理层<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-mysql"></i><span class="title">数据库系统</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-customize"></i><span class="title">单片机</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-regexp"></i><span class="title">正则表达式</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-setting"></i><span class="title">环境配置</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->传输层</h1><div class="article-info"><span class="author-info" arialabel="作者🖊" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" arialabelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://mrhope.site" target="_blank" rel="noopener noreferrer">CodeReaper</a></span><span property="author" content="CodeReaper"></span></span><!----><span class="date-info" arialabel="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" arialabelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2022年4月13日</span><meta property="datePublished" content="2022-04-13T13:54:04.000Z"></span><!----><!----><span class="reading-time-info" arialabel="阅读时间⌛" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" arialabelledby="timer"><title id="timer" lang="en">timer icon</title><g fill="currentColor"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></g></svg><span>大约 22 分钟</span><meta property="timeRequired" content="PT22M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#一、传输层基本介绍" class="router-link-active router-link-exact-active toc-link level2">一、传输层基本介绍</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-基本职能" class="router-link-active router-link-exact-active toc-link level3">1. 基本职能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-运输层端口号、复用分用的概念" class="router-link-active router-link-exact-active toc-link level3">2. 运输层端口号、复用分用的概念</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#二、udp与tcp对比" class="router-link-active router-link-exact-active toc-link level2">二、UDP与TCP对比</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-是否连接" class="router-link-active router-link-exact-active toc-link level3">1. 是否连接</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-单播、多播和广播" class="router-link-active router-link-exact-active toc-link level3">2. 单播、多播和广播</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-面向报文和面向字节流" class="router-link-active router-link-exact-active toc-link level3">3. 面向报文和面向字节流</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_4-可靠性" class="router-link-active router-link-exact-active toc-link level3">4. 可靠性</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_5-两种协议的格式" class="router-link-active router-link-exact-active toc-link level3">5. 两种协议的格式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_6-小结" class="router-link-active router-link-exact-active toc-link level3">6. 小结</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#三、tcp的流量控制" class="router-link-active router-link-exact-active toc-link level2">三、TCP的流量控制</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-流量控制的相关术语" class="router-link-active router-link-exact-active toc-link level3">1. 流量控制的相关术语</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-流量控制的流程" class="router-link-active router-link-exact-active toc-link level3">2. 流量控制的流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-小结" class="router-link-active router-link-exact-active toc-link level3">3. 小结</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#四、tcp的拥塞控制" class="router-link-active router-link-exact-active toc-link level2">四、TCP的拥塞控制</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-简单介绍" class="router-link-active router-link-exact-active toc-link level3">1. 简单介绍</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-拥塞控制算法" class="router-link-active router-link-exact-active toc-link level3">2. 拥塞控制算法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-相关概念" class="router-link-active router-link-exact-active toc-link level3">3. 相关概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_4-拥塞控制的流程" class="router-link-active router-link-exact-active toc-link level3">4. 拥塞控制的流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_5-例题" class="router-link-active router-link-exact-active toc-link level3">5. 例题</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#五、tcp超时重传时间rto的计算" class="router-link-active router-link-exact-active toc-link level2">五、TCP超时重传时间RTO的计算</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-问题引入" class="router-link-active router-link-exact-active toc-link level3">1. 问题引入</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-rto计算公式" class="router-link-active router-link-exact-active toc-link level3">2. RTO计算公式</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#六、tcp滑动窗口和可靠传输" class="router-link-active router-link-exact-active toc-link level2">六、TCP滑动窗口和可靠传输</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-基于滑动窗口的发送过程" class="router-link-active router-link-exact-active toc-link level3">1. 基于滑动窗口的发送过程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-注意点" class="router-link-active router-link-exact-active toc-link level3">2. 注意点</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-例题" class="router-link-active router-link-exact-active toc-link level3">3. 例题</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#七、tcp连接的建立" class="router-link-active router-link-exact-active toc-link level2">七、TCP连接的建立</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-连接建立需要解决的问题" class="router-link-active router-link-exact-active toc-link level3">1. 连接建立需要解决的问题</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-连接的建立过程" class="router-link-active router-link-exact-active toc-link level3">2. 连接的建立过程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-例题-1" class="router-link-active router-link-exact-active toc-link level3">3. 例题</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#八、tcp连接的释放" class="router-link-active router-link-exact-active toc-link level2">八、TCP连接的释放</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#九、tcp报文的首部格式" class="router-link-active router-link-exact-active toc-link level2">九、TCP报文的首部格式</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-字节流和tcp报文段的关系" class="router-link-active router-link-exact-active toc-link level3">1. 字节流和TCP报文段的关系</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-格式与各部分的功能" class="router-link-active router-link-exact-active toc-link level3">2. 格式与各部分的功能</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h1 id="传输层" tabindex="-1"><a class="header-anchor" href="#传输层" aria-hidden="true">#</a> 传输层</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#一、传输层基本介绍" class="router-link-active router-link-exact-active">一、传输层基本介绍</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-基本职能" class="router-link-active router-link-exact-active">1. 基本职能</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-运输层端口号、复用分用的概念" class="router-link-active router-link-exact-active">2. 运输层端口号、复用分用的概念</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#二、udp与tcp对比" class="router-link-active router-link-exact-active">二、UDP与TCP对比</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-是否连接" class="router-link-active router-link-exact-active">1. 是否连接</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-单播、多播和广播" class="router-link-active router-link-exact-active">2. 单播、多播和广播</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-面向报文和面向字节流" class="router-link-active router-link-exact-active">3. 面向报文和面向字节流</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_4-可靠性" class="router-link-active router-link-exact-active">4. 可靠性</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_5-两种协议的格式" class="router-link-active router-link-exact-active">5. 两种协议的格式</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_6-小结" class="router-link-active router-link-exact-active">6. 小结</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#三、tcp的流量控制" class="router-link-active router-link-exact-active">三、TCP的流量控制</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-流量控制的相关术语" class="router-link-active router-link-exact-active">1. 流量控制的相关术语</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-流量控制的流程" class="router-link-active router-link-exact-active">2. 流量控制的流程</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-小结" class="router-link-active router-link-exact-active">3. 小结</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#四、tcp的拥塞控制" class="router-link-active router-link-exact-active">四、TCP的拥塞控制</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-简单介绍" class="router-link-active router-link-exact-active">1. 简单介绍</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-拥塞控制算法" class="router-link-active router-link-exact-active">2. 拥塞控制算法</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-相关概念" class="router-link-active router-link-exact-active">3. 相关概念</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_4-拥塞控制的流程" class="router-link-active router-link-exact-active">4. 拥塞控制的流程</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_5-例题" class="router-link-active router-link-exact-active">5. 例题</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#五、tcp超时重传时间rto的计算" class="router-link-active router-link-exact-active">五、TCP超时重传时间RTO的计算</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-问题引入" class="router-link-active router-link-exact-active">1. 问题引入</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-rto计算公式" class="router-link-active router-link-exact-active">2. RTO计算公式</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#六、tcp滑动窗口和可靠传输" class="router-link-active router-link-exact-active">六、TCP滑动窗口和可靠传输</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-基于滑动窗口的发送过程" class="router-link-active router-link-exact-active">1. 基于滑动窗口的发送过程</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-注意点" class="router-link-active router-link-exact-active">2. 注意点</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-例题" class="router-link-active router-link-exact-active">3. 例题</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#七、tcp连接的建立" class="router-link-active router-link-exact-active">七、TCP连接的建立</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-连接建立需要解决的问题" class="router-link-active router-link-exact-active">1. 连接建立需要解决的问题</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-连接的建立过程" class="router-link-active router-link-exact-active">2. 连接的建立过程</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_3-例题-1" class="router-link-active router-link-exact-active">3. 例题</a></li></ul></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#八、tcp连接的释放" class="router-link-active router-link-exact-active">八、TCP连接的释放</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#九、tcp报文的首部格式" class="router-link-active router-link-exact-active">九、TCP报文的首部格式</a><ul><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_1-字节流和tcp报文段的关系" class="router-link-active router-link-exact-active">1. 字节流和TCP报文段的关系</a></li><li><a aria-current="page" href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03%E4%BC%A0%E8%BE%93%E5%B1%82.html#_2-格式与各部分的功能" class="router-link-active router-link-exact-active">2. 格式与各部分的功能</a></li></ul></li></ul></nav><h2 id="一、传输层基本介绍" tabindex="-1"><a class="header-anchor" href="#一、传输层基本介绍" aria-hidden="true">#</a> 一、传输层基本介绍</h2><h3 id="_1-基本职能" tabindex="-1"><a class="header-anchor" href="#_1-基本职能" aria-hidden="true">#</a> 1. 基本职能</h3><p>传输层位于计算机网络体系五层结构中的第四层，它的职能是：为运行在<strong>不同主机</strong>上的<strong>进程</strong>提供<strong>直接的通信服务</strong>。</p><p>和网络层提供服务的范围差异如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211115819861.png" alt="image-20220211115819861" style="zoom:67%;"><p>即<strong>网络层</strong>提供了<strong>主机到主机间的通信</strong>（如果是IP协议的话还是不可靠的通信），而<strong>传输层</strong>提供的是<strong>主机中的进程与进程</strong>之间的通信（TCP协议提供可靠传输，UDP协议提供不可靠传输）。</p><p>更加直观的示意图如下所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211120151461.png" alt="image-20220211120151461" style="zoom:67%;"><h3 id="_2-运输层端口号、复用分用的概念" tabindex="-1"><a class="header-anchor" href="#_2-运输层端口号、复用分用的概念" aria-hidden="true">#</a> 2. 运输层端口号、复用分用的概念</h3><h4 id="端口号" tabindex="-1"><a class="header-anchor" href="#端口号" aria-hidden="true">#</a> 端口号</h4><p>为了使运行不同操作系统的计算机的应用进程之间能够进行网络通信，就必须使用统一的方法对TCP/IP体系的应用进程进行标识。</p><p>这里用于标识不同应用进程的东西就是端口号：</p><ul><li>端口号使用16比特表示，取值范围0~65535；</li><li>端口号只具有本地意义，即端口号只是为了标识本计算机应用层中的各进程，在因特网中，不同计算机中的相同端口号是没有联系的。</li></ul><p>端口号分类：</p><table><thead><tr><th style="text-align:left;">熟知端口号</th><th style="text-align:left;">登记端口号</th><th style="text-align:left;">短暂端口号</th></tr></thead><tbody><tr><td style="text-align:left;">熟知端口号: 0~1023, IANA把这些端口号指派给了TCP/IP体系中最重要的一些应用协议，例如: FTP使用21/20，HTTP使用80，DNS使用53。</td><td style="text-align:left;">1024~49151, 为没有熟知端口号的应用程序使用。使用这类端口号必须在IANA按照规定的手续登记，以防止重复。例如：Microsoft RDP微软远程桌面使用的端口是3389。</td><td style="text-align:left;">49152~65535, 留给<strong>客户进程选择暂时使用</strong>。当服务器进程收到客户进程的报文时，就知道了客户进程所使用的动态端口号。通信结束后，这个端口号可供其他客户进程以后使用。</td></tr></tbody></table><h4 id="发送方的复用和接收方的分用" tabindex="-1"><a class="header-anchor" href="#发送方的复用和接收方的分用" aria-hidden="true">#</a> 发送方的复用和接收方的分用</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212002638904.png" alt="image-20220212002638904" style="zoom:67%;"><p>TCP/IP体系结构应用层常用协议所使用的运输层熟知端口号：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212002805501.png" alt="image-20220212002805501" style="zoom:55%;"><h2 id="二、udp与tcp对比" tabindex="-1"><a class="header-anchor" href="#二、udp与tcp对比" aria-hidden="true">#</a> 二、UDP与TCP对比</h2><p>UDP和TCP是计算机网络层的两个重要协议，如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211120614051.png" alt="image-20220211120614051" style="zoom:80%;"><h3 id="_1-是否连接" tabindex="-1"><a class="header-anchor" href="#_1-是否连接" aria-hidden="true">#</a> 1. 是否连接</h3><p>UDP协议是无连接的，TCP协议是面向连接的，如下所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211121223541.png" alt="image-20220211121223541" style="zoom:67%;"><h3 id="_2-单播、多播和广播" tabindex="-1"><a class="header-anchor" href="#_2-单播、多播和广播" aria-hidden="true">#</a> 2. 单播、多播和广播</h3><table><thead><tr><th style="text-align:center;">UDP</th><th style="text-align:center;">TCP</th></tr></thead><tbody><tr><td style="text-align:center;"><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211121504228.png" alt="image-20220211121504228" style="zoom:67%;"></td><td style="text-align:center;"><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211121516739.png" alt="image-20220211121516739" style="zoom:67%;"></td></tr></tbody></table><h3 id="_3-面向报文和面向字节流" tabindex="-1"><a class="header-anchor" href="#_3-面向报文和面向字节流" aria-hidden="true">#</a> 3. 面向报文和面向字节流</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211121707604.png" alt="image-20220211121707604" style="zoom:67%;"><p>之所以TCP需要面向字节流，是因为TCP需要实现<strong>可靠传输、流量控制和拥塞控制</strong>，面向字节流是实现上述技术的基础。</p><h3 id="_4-可靠性" tabindex="-1"><a class="header-anchor" href="#_4-可靠性" aria-hidden="true">#</a> 4. 可靠性</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211122051053.png" alt="image-20220211122051053" style="zoom:67%;"><h3 id="_5-两种协议的格式" tabindex="-1"><a class="header-anchor" href="#_5-两种协议的格式" aria-hidden="true">#</a> 5. 两种协议的格式</h3><table><thead><tr><th style="text-align:center;">UDP</th><th style="text-align:center;">TCP</th></tr></thead><tbody><tr><td style="text-align:center;"><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211122219221.png" alt="image-20220211122219221" style="zoom:67%;"></td><td style="text-align:center;"><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211122231412.png" alt="image-20220211122231412" style="zoom:67%;"></td></tr></tbody></table><p>因为TCP需要实现的功能较为复杂，因此TCP报文段的首部要比UDP数据包的首部大得多。</p><h3 id="_6-小结" tabindex="-1"><a class="header-anchor" href="#_6-小结" aria-hidden="true">#</a> 6. 小结</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211122424798.png" alt="image-20220211122424798" style="zoom:60%;"><h2 id="三、tcp的流量控制" tabindex="-1"><a class="header-anchor" href="#三、tcp的流量控制" aria-hidden="true">#</a> 三、TCP的流量控制</h2><p>一般情况下，我们都是希望信息可以尽快传输，但如果是TCP连接一对一进行传输时，如果不进行流量控制，就会出现一方传输速度过快，导致另一方的<strong>接收信息的缓存满了</strong>，如果再继续发送信息只会导致<strong>这部分信息的丢失</strong>，然后需要进行信息重传等操作，进而不仅信息传输比原来要慢很多，还占用了很多额外的网络资源。</p><p>TCP协议采用了滑动窗口的机制来进行流量控制。</p><h3 id="_1-流量控制的相关术语" tabindex="-1"><a class="header-anchor" href="#_1-流量控制的相关术语" aria-hidden="true">#</a> 1. 流量控制的相关术语</h3><p><strong>发送窗口和接收窗口</strong></p><p>逻辑上，发送端有一个控制发送数据量的窗口，称为<strong>发送窗口</strong>，当发送端将发送窗口中的所有数据都发送出去后，还没有收到接收端的应答之前，都不能进行下一步的操作，例如移动窗口，发送新数据等等。</p><p>而<strong>接收窗口</strong>相当于接收端当前可以接受数据量的大小。</p><p>发送窗口的大小由接收端（接收窗口大小）来决定，这是保证流量控制，保证数据不溢出的关键。</p><h3 id="_2-流量控制的流程" tabindex="-1"><a class="header-anchor" href="#_2-流量控制的流程" aria-hidden="true">#</a> 2. 流量控制的流程</h3><ol><li>发送端发送自己发送窗口中的全部或部分数据到接收端，例如（浅蓝色部分为已发送部分）： <img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211124031141.png" alt="image-20220211124031141" style="zoom:80%;"></li><li>接收端接收到后发送相应数据，其中包括：<strong>对数据的累计确认</strong>和<strong>当前接收窗口的大小(rwnd)</strong>。</li><li>发送端接收到<strong>数据确认信息</strong>和<strong>rwnd</strong>后将<strong>①发送窗口前移，②调整窗口的大小</strong>，再将<strong>已确认的数据从发送缓存中删除</strong>，然后回到1继续进行</li></ol><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/new.gif.gif" alt="new.gif" style="zoom:80%;"><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211125109090.png" alt="image-20220211125109090" style="zoom:80%;"><p>当前接收方发送的rwnd为0，即接受窗口的大小为0，所以发送窗口也被调控为0，因而发送方无法继续发送数据。</p><p>考虑当接收方又出现了一定的接收空间，然后将当前的rwnd发送到发送方，但此时这个报文段丢失了，那么发送端无法接收到rwnd的变化信息，因而又无法发送数据，此时就会造成双方都在等待对方相应的状况，即死锁，如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211162355175.png" alt="image-20220211162355175" style="zoom:80%;"><p>其实这种情况下，即发送方接收到<code>rwnd=0</code>的信息后会启动持续计时器，当这个阶段还未接收到接收端发来的信息时就会发送零窗口探测报文进行询问，以打破死锁局面：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211162955754.png" alt="image-20220211162955754" style="zoom:80%;"><blockquote><p>疑问1：零窗口探测报文如果丢失了怎么处理？回答：零窗口探测报文也有超时重传计时器，保证可以不断发送探测报文</p><p>疑问2：如果接收窗口为0如何接收零窗口探测报文？回答：TCP规定这种特殊情况的报文接收端也必须有机制进行接收</p></blockquote><p>例题：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211163314675.png" alt="image-20220211163314675" style="zoom:70%;"><h3 id="_3-小结" tabindex="-1"><a class="header-anchor" href="#_3-小结" aria-hidden="true">#</a> 3. 小结</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211163422081.png" alt="image-20220211163422081" style="zoom:67%;"><h2 id="四、tcp的拥塞控制" tabindex="-1"><a class="header-anchor" href="#四、tcp的拥塞控制" aria-hidden="true">#</a> 四、TCP的拥塞控制</h2><h3 id="_1-简单介绍" tabindex="-1"><a class="header-anchor" href="#_1-简单介绍" aria-hidden="true">#</a> 1. 简单介绍</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211164903698.png" alt="image-20220211164903698" style="zoom:67%;"><h3 id="_2-拥塞控制算法" tabindex="-1"><a class="header-anchor" href="#_2-拥塞控制算法" aria-hidden="true">#</a> 2. 拥塞控制算法</h3><p>包括四个子算法：</p><ul><li>慢开始</li><li>拥塞避免</li><li>快重传</li><li>快恢复</li></ul><h3 id="_3-相关概念" tabindex="-1"><a class="header-anchor" href="#_3-相关概念" aria-hidden="true">#</a> 3. 相关概念</h3><p>为了实现拥塞控制，发送方除了需要维护<strong>swnd（发送窗口）<strong>之外，还需要额外维护一个</strong>新的变量cwnd（拥塞窗口）</strong>，它的值<strong>取决于拥塞程度</strong>，而且动态变化。</p><p>此时，<code>swnd = min(rwnd, cwnd)</code>，即发送窗口的大小应为<strong>接收窗口和拥塞窗口的最小值</strong>，进而<strong>同时实现流量控制和拥塞控制</strong>。</p><p><strong>cwnd的变化规律</strong>：</p><ol><li>网络没有出现拥塞时，cwnd再增大一些</li><li>一旦出现拥塞，cwnd就要减小一些</li></ol><blockquote><p><strong>判断网络是否发生拥塞的依据</strong>：</p><ol><li>重传定时器超时</li><li>收到三个相同（重复）的 ACK</li></ol><p>其实这两个依据的本质都是相同的，即<strong>发出的报文段丢失了</strong>。</p></blockquote><p>最后，为了cwnd的增大变化更加合理，在特定的情况下采用特定的算法进行增大，发送端还需要维护一个慢开始门限变量ssthresh状态变量：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211170613192.png" alt="image-20220211170613192" style="zoom:80%;"><h3 id="_4-拥塞控制的流程" tabindex="-1"><a class="header-anchor" href="#_4-拥塞控制的流程" aria-hidden="true">#</a> 4. 拥塞控制的流程</h3><p>为了能够更简单地说明问题，假定如下条件：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211165158896.png" alt="image-20220211165158896" style="zoom:67%;"><h4 id="_4-1-慢开始" tabindex="-1"><a class="header-anchor" href="#_4-1-慢开始" aria-hidden="true">#</a> 4.1 慢开始</h4><p>连接成功后，假设发送端的拥塞窗口值被设置为1，此外还需要设置慢开始门限的初始值，这里以16为例。</p><p>慢开始算法：每次收到一个ACK，cwnd += 1。</p><p>具体案例如下所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211171932054.png" alt="image-20220211171932054" style="zoom:67%;"><p>因此在理想情况下运行慢开始算法时是每接收到一轮回复时<code>cwnd *= 2</code>，我们在做题时往往是考虑这样的理想情况的。</p><p>拥塞窗口的大小随传输轮次的增大的变化如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211172201003.png" alt="image-20220211172201003" style="zoom:67%;"><h4 id="_4-2-拥塞避免" tabindex="-1"><a class="header-anchor" href="#_4-2-拥塞避免" aria-hidden="true">#</a> 4.2 拥塞避免</h4><p>当cwnd达到ssthresh（慢开始门限）时，就会转而运行拥塞避免算法，即：每收到一个新的ACK，将CWND += MSS / CWND</p><p>在理想条件下，若每个ACK都没有延迟，则在每个RTT之后，cwnd的变化相当于<code>cwnd += 1</code>。</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211172712257.png" alt="image-20220211172712257" style="zoom:67%;"><p>当出现某报文段发生超时重传时，判断网络发生了拥塞，此时进行如下操作：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211173000784.png" alt="image-20220211173000784" style="zoom:67%;"><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211173055584.png" alt="image-20220211173055584" style="zoom:80%;"><p>即步骤为：</p><ol><li>执行慢开始算法</li><li>cwnd达到ssthresh后执行拥塞避免算法</li><li>发生拥塞后更新：<code>ssthresh /= 2; cwnd = 1;</code>，然后转1继续运行</li></ol><p>按照以上步骤执行直到信息发送完全为止。</p><p>因而总的流程如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211173424380.png" alt="image-20220211173424380" style="zoom:67%;"><blockquote><p>tips：</p><ul><li>“慢开始”是指<strong>一开始向网络注入的报文段少</strong>，并不是指拥塞窗口cwnd增长速度慢；</li><li>“拥塞避免”并非指完全能够避免拥塞，而是指在拥塞避免阶段将拥塞窗口控制为<strong>按线性规律增长</strong>，使网络比较<strong>不容易出现拥塞</strong>；</li></ul></blockquote><p><strong>慢开始</strong>和<strong>拥塞避免</strong>算法是1988年提出的TCP拥塞控制算法（<strong>TCP Tahoe版本</strong>）。</p><p>1990年又增加了<strong>两个新的拥塞控制算法</strong>(改进TCP的性能)，这就是<strong>快重传</strong>和<strong>快恢复</strong>（<strong>TCP Reno版本</strong>）。</p><p>原因：有时，个别报文段会在网络中丢失，但实际上网络<strong>并未发生拥塞</strong>。这将导致发送方超时重传，并<strong>误认为网络发生了拥塞</strong>，进而发送方把拥塞窗口cwnd又设置为最小值1，并错误地启动慢开始算法，因而<strong>降低了传输效率</strong>。</p><h4 id="_4-3-快重传" tabindex="-1"><a class="header-anchor" href="#_4-3-快重传" aria-hidden="true">#</a> 4.3 快重传</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211174231294.png" alt="image-20220211174231294" style="zoom:70%;"><p>执行快重传算法的过程如下：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211174727675.png" alt="image-20220211174727675" style="zoom:80%;"><p>即使用这个算法可以<strong>减少发送端对网络拥塞的误判</strong>，使发送端更早地对丢失报文段进行重传，进而<strong>提高传输效率</strong>。</p><h4 id="_4-4-快恢复" tabindex="-1"><a class="header-anchor" href="#_4-4-快恢复" aria-hidden="true">#</a> 4.4 快恢复</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211175534779.png" alt="image-20220211175534779" style="zoom:70%;"><h4 id="_4-5-四种算法的综合使用" tabindex="-1"><a class="header-anchor" href="#_4-5-四种算法的综合使用" aria-hidden="true">#</a> 4.5 四种算法的综合使用</h4><p>下图的传输过程包括了四种算法的使用：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211175644929.png" alt="image-20220211175644929" style="zoom:67%;"><p>TCP Reno版本的拥塞控制如下：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211182159435.png" alt="image-20220211182159435" style="zoom:67%;"><h3 id="_5-例题" tabindex="-1"><a class="header-anchor" href="#_5-例题" aria-hidden="true">#</a> 5. 例题</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211180344768.png" alt="image-20220211180344768" style="zoom:67%;"><h2 id="五、tcp超时重传时间rto的计算" tabindex="-1"><a class="header-anchor" href="#五、tcp超时重传时间rto的计算" aria-hidden="true">#</a> 五、TCP超时重传时间RTO的计算</h2><h3 id="_1-问题引入" tabindex="-1"><a class="header-anchor" href="#_1-问题引入" aria-hidden="true">#</a> 1. 问题引入</h3><ul><li><p>RTO太小时</p></li><li><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211183821049.png" alt="image-20220211183821049" style="zoom:67%;"></li><li><p>RTO太大时</p></li><li><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211183910642.png" alt="image-20220211183910642" style="zoom:67%;"></li></ul><p>可见，RTO太小或太大都不合适，太小时会使网络符合增大，太大时会降低传输速率。</p><p>因此，一般我们会取一个<strong>比往返时间RTT稍大的值作为RTO的值</strong>，如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211184049705.png" alt="image-20220211184049705" style="zoom:67%;"><h3 id="_2-rto计算公式" tabindex="-1"><a class="header-anchor" href="#_2-rto计算公式" aria-hidden="true">#</a> 2. RTO计算公式</h3><p>要计算RTO，首先我们需要先计算加权平均往返时间RTT<sub>S</sub>，计算公式为：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211184423479.png" alt="image-20220211184423479" style="zoom:80%;"><p>即新的RTT<sub>S</sub>由新的RTT样本和旧的RTT<sub>S</sub>同时决定，里面α的取值确定了两者的重要性，根据标准一般取值为1/8，即旧的RTT<sub>S</sub>权重较大：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211184623480.png" alt="image-20220211184623480" style="zoom:80%;"><p>而RTO的大小要略大于RTT<sub>S</sub>，其完整的计算公式如下：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211184710194.png" alt="image-20220211184710194" style="zoom:50%;"><p>RTT<sub>S</sub>的计算过程已经提到过了，即：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211184745119.png" alt="image-20220211184745119" style="zoom:67%;"><p>而RTT<sub>D</sub>的计算如下：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211184858062.png" alt="image-20220211184858062" style="zoom:67%;"><p>按道理我们已经可以计算每一传输轮次的RTT<sub>S</sub>了，但是实际上还是会出现问题，这里主要是RTT样本在发生重传时很可能出现偏差，如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211200932503.png" alt="image-20220211200932503" style="zoom:67%;"><p>因此我们需要解决这种网络不可靠情况下的RTT测量问题，这里主要是使用Karn算法：</p><p><strong>在计算RTT<sub>S</sub>的过程中，只要报文段进行了重传，就不采用该报文传输得到的RTT样本。</strong>（样本重传不采用）</p><p>但这样也会出现特殊情况无法更新RTO：报文段的<strong>时延突然增大了很多</strong>，并且之后很长一段时间都会保持这种时延。因此<strong>在原来得出的重传时间内，不会收到确认报文段</strong>。于是就重传报文段。但根据Karn算法，不考虑重传的报文段的往返时间样本。这样，<strong>超时重传时间就无法更新</strong>。这会导致<strong>报文段反复被重传</strong>。</p><p>因此我们使用修正后的Karn算法：报文段<strong>每重传一次</strong>，就<strong>把超时重传时间RTO增大一些</strong>。典型的做法是将<strong>新RTO的值取为旧RTO值的2倍</strong>。(<code>RTO *= 2</code>)</p><p>以下是一个计算的例子：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211202702569.png" alt="image-20220211202702569" style="zoom:80%;"><p><strong>总的计算方法如下图所示：</strong></p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211202822238.png" alt="image-20220211202822238" style="zoom:67%;"><h2 id="六、tcp滑动窗口和可靠传输" tabindex="-1"><a class="header-anchor" href="#六、tcp滑动窗口和可靠传输" aria-hidden="true">#</a> 六、TCP滑动窗口和可靠传输</h2><h3 id="_1-基于滑动窗口的发送过程" tabindex="-1"><a class="header-anchor" href="#_1-基于滑动窗口的发送过程" aria-hidden="true">#</a> 1. 基于滑动窗口的发送过程</h3><p>TCP基于<strong>以字节为单位的滑动窗口</strong>来实现<strong>可靠传输</strong>。</p><p>滑动窗口示意图如下所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211204441884.png" alt="image-20220211204441884" style="zoom:67%;"><p>实现上维护3个指针来描述发送窗口的状态：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211204551590.png" alt="image-20220211204551590" style="zoom:67%;"><p>具体的报文段发送过程如下所示：</p><img src="https://cdn.jsdelivr.net/gh/hututu-tech/IMG-gongfeng@main/2022/02/11/62065dab4c706.gif" style="zoom:67%;"><h3 id="_2-注意点" tabindex="-1"><a class="header-anchor" href="#_2-注意点" aria-hidden="true">#</a> 2. 注意点</h3><h4 id="发送窗口大小" tabindex="-1"><a class="header-anchor" href="#发送窗口大小" aria-hidden="true">#</a> 发送窗口大小</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211210216692.png" alt="image-20220211210216692" style="zoom:70%;"><h4 id="对不按序到达数据的处理" tabindex="-1"><a class="header-anchor" href="#对不按序到达数据的处理" aria-hidden="true">#</a> 对不按序到达数据的处理</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211210257197.png" alt="image-20220211210257197" style="zoom:70%;"><h4 id="确认机制" tabindex="-1"><a class="header-anchor" href="#确认机制" aria-hidden="true">#</a> 确认机制</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211210325411.png" alt="image-20220211210325411" style="zoom:70%;"><h4 id="通信方式" tabindex="-1"><a class="header-anchor" href="#通信方式" aria-hidden="true">#</a> 通信方式</h4><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211210347162.png" alt="image-20220211210347162" style="zoom:70%;"><h3 id="_3-例题" tabindex="-1"><a class="header-anchor" href="#_3-例题" aria-hidden="true">#</a> 3. 例题</h3><p>例1：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211210652060.png" alt="image-20220211210652060" style="zoom:67%;"><p>例2：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211210716190.png" alt="image-20220211210716190" style="zoom:67%;"><h2 id="七、tcp连接的建立" tabindex="-1"><a class="header-anchor" href="#七、tcp连接的建立" aria-hidden="true">#</a> 七、TCP连接的建立</h2><p>TCP是<strong>面向连接</strong>的协议，它基于运输连接来传送TCP报文段。因此TCP运输连接的建立和释放是每一次面向连接的通信中必不可少的过程。</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211213025869.png" alt="image-20220211213025869" style="zoom:80%;"><h3 id="_1-连接建立需要解决的问题" tabindex="-1"><a class="header-anchor" href="#_1-连接建立需要解决的问题" aria-hidden="true">#</a> 1. 连接建立需要解决的问题</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211213132372.png" alt="image-20220211213132372" style="zoom:67%;"><h3 id="_2-连接的建立过程" tabindex="-1"><a class="header-anchor" href="#_2-连接的建立过程" aria-hidden="true">#</a> 2. 连接的建立过程</h3><p>首先TCP服务器自身先建立相应的传输控制块，内容如下，并进入监听状态，等待TCP客户进程的连接请求：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211213359452.png" alt="image-20220211213359452" style="zoom:80%;"><p>然后TCP客户端发送TCP连接请求 <code>SYN = 1, seq = x</code>，SYN设置为1代表这是一个连接请求，且TCP规定当SYN设置为1的报文段不能携带数据，并要消耗掉一个序号seq，示意图如下：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211213928861.png" alt="image-20220211213928861" style="zoom:67%;"><p>当TCP服务器接收到该请求后，会发送一个TCP连接请求的确认，<code>SYN = 1, ACK = 1</code>代表这是对连接请求的确认，而 <code>ack = x+1</code> 表示对收到的请求报文的应答。同理，这个报文段也不能携带数据并要消耗掉一个序号seq。</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211213840598.png" alt="image-20220211213840598" style="zoom:67%;"><p>最后TCP客户端接收到服务器的确认后还需再发送一个报文段进行应答，至TCP服务器接收到该报文后，连接正式建立：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211214618812.png" alt="image-20220211214618812" style="zoom:67%;"><blockquote><p>三报文握手能否简化成两报文？</p><p>不能，一个简单的考量是：</p><ol><li>TCP客户发送连接请求后TCP服务器接收到时可以证明TCP<strong>客户端</strong>可以<strong>发送数据</strong></li><li>TCP服务器发送连接确认报文TCP客户接收到后可以证明<strong>服务器</strong>可以<strong>发送和接收数据</strong></li></ol><p>但如果不再发送一个额外的请求则<strong>无法证明客户端可以接受数据</strong>，因而无法保证连接的可靠性。</p><p>另外特殊的情况如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211215402791.png" alt="image-20220211215402791" style="zoom:67%;"></blockquote><h3 id="_3-例题-1" tabindex="-1"><a class="header-anchor" href="#_3-例题-1" aria-hidden="true">#</a> 3. 例题</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211215507279.png" alt="image-20220211215507279" style="zoom:67%;"><h2 id="八、tcp连接的释放" tabindex="-1"><a class="header-anchor" href="#八、tcp连接的释放" aria-hidden="true">#</a> 八、TCP连接的释放</h2><p>TCP通过“四报文挥手”释放连接。客户端和服务器都可以发起释放连接请求。</p><p>这里假设TCP客户端主动发起释放连接请求：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211215908020.png" alt="image-20220211215908020" style="zoom:67%;"><p>其中 <code>FIN = 1</code> 表示这是释放连接请求报文段，另外<code>ACK = 1, ack = v</code>为对前面接收到的报文段进行确认，同理，释放连接请求也需要消耗掉一个序号<code>seq = u</code>。</p><p>然后TCP服务器发送一个释放连接的确认报文，并通知应用进程，至此TCP客户到服务器的单向传输就关闭了：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211220338485.png" alt="image-20220211220338485" style="zoom:67%;"><p>此时TCP连接处于半关闭状态，即<strong>客户到服务器的连接断开</strong>，但服务器到客户的连接仍继续，<strong>服务器还可以继续向客户端发送数据</strong>：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211220548996.png" alt="image-20220211220548996" style="zoom:67%;"><p>当服务器要发送的数据也发送结束后，则<strong>服务器端也会发送一个释放服务器到客户端方向连接的请求</strong>，和客户端发送的释放请求的过程基本一致：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211220755014.png" alt="image-20220211220755014" style="zoom:67%;"><p>而客户端接收到释放请求时<strong>发送释放确认</strong>，并在<strong>等待2MSL后关闭连接</strong>，而<strong>服务器接收到该确认后直接关闭连接</strong>：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211221006258.png" alt="image-20220211221006258" style="zoom:67%;"><p>最后的这个等待时间是为了防止发生这种情况：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211221209486.png" alt="image-20220211221209486" style="zoom:67%;"><p>此外当连接过程中客户端出现故障时有这样的处理方案：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220211221320615.png" alt="image-20220211221320615" style="zoom:67%;"><h2 id="九、tcp报文的首部格式" tabindex="-1"><a class="header-anchor" href="#九、tcp报文的首部格式" aria-hidden="true">#</a> 九、TCP报文的首部格式</h2><h3 id="_1-字节流和tcp报文段的关系" tabindex="-1"><a class="header-anchor" href="#_1-字节流和tcp报文段的关系" aria-hidden="true">#</a> 1. 字节流和TCP报文段的关系</h3><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212000221364.png" alt="image-20220212000221364" style="zoom:67%;"><h3 id="_2-格式与各部分的功能" tabindex="-1"><a class="header-anchor" href="#_2-格式与各部分的功能" aria-hidden="true">#</a> 2. 格式与各部分的功能</h3><p>整体格式如下图所示：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212000313725.png" alt="image-20220212000313725" style="zoom:80%;"><ul><li>源端口：占16比特，写入源端口号，用来<strong>标识发送该TCP报文段的应用进程</strong>。</li><li>目的端口：占16比特，写入目的端口号，用来<strong>标识接收该TCP报文段的应用进程</strong>。</li></ul><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212000419348.png" alt="image-20220212000419348" style="zoom:67%;"><ul><li>序号seq：占32比特，取值范围[0, 2<sup>32</sup>- 1]，序号增加到最后一个后，下一个序号就又回到0。 指出本TCP报文段数据载荷的<strong>第一个字节的序号</strong>。</li></ul><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212000532137.png" alt="image-20220212000532137" style="zoom:67%;"><ul><li><p>确认号ack：占32比特，取值范围[0, 2<sup>32</sup>- 1],确认号增加到最后一个后，下一个确认号就又回到0。 指出<strong>期望收到对方下一个TCP报文段的数据载荷的第一个字节的序号</strong>，同时也是<strong>对之前收到的所有数据的确认</strong>。（累计确认） 若确认号=n，则表明到序号n-1为止的所有数据都已正确接收，期望接收序号为n的数据。</p></li><li><p>确认标志位ACK：<strong>取值为1时确认号字段才有效</strong>；取值为0时确认号字段无效。 TCP规定，在<strong>连接建立后所有传送的TCP报文段都必须把ACK置1</strong>。</p></li></ul><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212000906952.png" alt="image-20220212000906952" style="zoom:67%;"><ul><li>数据偏移：占4比特， 并<strong>以4字节为单位</strong>。 用来指出TCP报文段的<strong>数据载荷部分的起始处距离TCP报文段的起始处有多远</strong>。 这个字段实际上是指出了<strong>TCP报文段的首部长度</strong>。 首部固定长度为20字节，因此数据偏移字段的最小值为(0101)2 首部最大长度为60字节，因此数据偏移字段的最大值为(1111)2</li></ul><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212001043325.png" alt="image-20220212001043325" style="zoom:67%;"><ul><li><p>保留：占6比特，保留为今后使用，但目前应置为0。</p></li><li><p>窗口：占16比特，以字节为单位。指出<strong>发送本报文段的一方</strong>的<strong>接收窗口</strong>（cwnd）。 窗口值作为接收方让发送方设置其发送窗口的依据。 这是以接收方的接收能力来控制发送方的发送能力，称为<strong>流量控制</strong>。</p></li><li><p>校验和：占16比特，<strong>检查范围</strong>包括TCP报文段的<strong>首部和数据载荷</strong>两部分。 在<strong>计算校验和</strong>时，要在TCP报文段的<strong>前面加上12字节的伪首部</strong>。</p></li></ul><p>几个标志位：</p><ul><li><p>同步标志位SYN：在TCP连接建立时用来同步序号。</p></li><li><p>终止标志位FIN：用来释放TCP连接。</p></li><li><p>复位标志位RST：用来<strong>复位</strong>TCP连接。 当RST=1时，表明TCP连接出现了异常，<strong>必须释放连接，然后再重新建立连接</strong>。 RST置1还用来拒绝一个非法的报文段或拒绝打开一个TCP连接。</p></li><li><p>推送标志位PSH：接收方的TCP收到该标志位为1的报文段会<strong>尽快上交应用进程</strong>，而不必等到接收缓存都填满后再向上交付。</p></li></ul><p>URG和紧急指针：</p><p>紧急标志位URG：<strong>取值为1时紧急指针字段有效</strong>；取值为0时紧急指针字段无效。 紧急指针：占16比特，以<strong>字节</strong>为单位，用来指明紧急数据的长度。 当发送方有紧急数据时，可将紧急数据插队到发送缓存的最前面，并立刻<strong>封装到一个TCP报文段中进行发送</strong>。紧急指针会指出本报文段数据载荷部分包含了多长的紧急数据，紧急数据之后是普通数据。</p><p>选项部分：</p><img src="https://codereaper-image-bed.oss-cn-shenzhen.aliyuncs.com/img/my-picture-bed/image-20220212001805588.png" alt="image-20220212001805588" style="zoom:67%;"><ul><li>填充：由于选项的长度可变，因此使用填充来确<strong>保报文段首部能被4整除</strong> (因为数据偏移字段，也就是首部长度字段，是以4字节为单位的)。</li></ul><p>以上就是TCP报文首部各字段的详细含义。</p><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/demo/src/university-course/计算机网络/03传输层.md" rel="noopener noreferrer" target="_blank" arialabel="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" arialabelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/4/13 下午9:54:04</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 2210086948@qq.com">codeReaper2001</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/02%E5%BA%94%E7%94%A8%E5%B1%82.html" class="nav-link prev" arialabel="应用层"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->应用层</div></a><a href="/blog/university-course/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/04%E7%89%A9%E7%90%86%E5%B1%82.html" class="nav-link next" arialabel="物理层"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">物理层<!----></div></a></nav><!----><!----></main><!--]--><!----></div><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.9f3d4d71.js" defer></script>
  </body>
</html>
